<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ma Haotian" />

<meta name="date" content="2021-12-21" />

<title>Homework21035</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homework21035</h1>
<h4 class="author">Ma Haotian</h4>
<h4 class="date">2021-12-21</h4>



<div id="section" class="section level2">
<h2>09-16</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="use-knitr-to-produce-texts" class="section level4">
<h4>1.Use knitr to produce texts</h4>
<p>In this part, I simply defined a variable with text information and printed it.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span> <span class="st">&#39;Welcome to statistical computing!&#39;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>text</span></code></pre></div>
<pre><code>## [1] &quot;Welcome to statistical computing!&quot;</code></pre>
</div>
<div id="use-knitr-to-produce-figures" class="section level4">
<h4>2.Use knitr to produce figures</h4>
<p>In this part, firstly I defined two 30-unit variables, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, where <span class="math inline">\(X_i\sim N(1,1)\)</span> and <span class="math inline">\(Y_i\sim N(1,0.5^2)\)</span>. Then I used ‘plot’ function to draw one scatter plot of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">main =</span> <span class="st">&quot;Scatter plot of X and Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="use-knitr-to-produce-tables" class="section level4">
<h4>3.Use knitr to produce tables</h4>
<p>In this part, I printed two tables.</p>
<p>Firstly I printed the ‘state.x77’ dataset in a table. ‘State.x77’ includes data about population, income and so on of 50 states in the United States in 1977.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>state.x77.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(state.x77)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(state.x77.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Popul&quot;</span>, <span class="st">&quot;Income&quot;</span>, <span class="st">&quot;Illit&quot;</span>, <span class="st">&quot;LifeExp&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Murder&quot;</span>, <span class="st">&quot;HSGrad&quot;</span>, <span class="st">&quot;Frost&quot;</span>, <span class="st">&quot;Area&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>state.x77.df</span></code></pre></div>
<pre><code>##                Popul Income Illit LifeExp Murder HSGrad Frost   Area
## Alabama         3615   3624   2.1   69.05   15.1   41.3    20  50708
## Alaska           365   6315   1.5   69.31   11.3   66.7   152 566432
## Arizona         2212   4530   1.8   70.55    7.8   58.1    15 113417
## Arkansas        2110   3378   1.9   70.66   10.1   39.9    65  51945
## California     21198   5114   1.1   71.71   10.3   62.6    20 156361
## Colorado        2541   4884   0.7   72.06    6.8   63.9   166 103766
## Connecticut     3100   5348   1.1   72.48    3.1   56.0   139   4862
## Delaware         579   4809   0.9   70.06    6.2   54.6   103   1982
## Florida         8277   4815   1.3   70.66   10.7   52.6    11  54090
## Georgia         4931   4091   2.0   68.54   13.9   40.6    60  58073
## Hawaii           868   4963   1.9   73.60    6.2   61.9     0   6425
## Idaho            813   4119   0.6   71.87    5.3   59.5   126  82677
## Illinois       11197   5107   0.9   70.14   10.3   52.6   127  55748
## Indiana         5313   4458   0.7   70.88    7.1   52.9   122  36097
## Iowa            2861   4628   0.5   72.56    2.3   59.0   140  55941
## Kansas          2280   4669   0.6   72.58    4.5   59.9   114  81787
## Kentucky        3387   3712   1.6   70.10   10.6   38.5    95  39650
## Louisiana       3806   3545   2.8   68.76   13.2   42.2    12  44930
## Maine           1058   3694   0.7   70.39    2.7   54.7   161  30920
## Maryland        4122   5299   0.9   70.22    8.5   52.3   101   9891
## Massachusetts   5814   4755   1.1   71.83    3.3   58.5   103   7826
## Michigan        9111   4751   0.9   70.63   11.1   52.8   125  56817
## Minnesota       3921   4675   0.6   72.96    2.3   57.6   160  79289
## Mississippi     2341   3098   2.4   68.09   12.5   41.0    50  47296
## Missouri        4767   4254   0.8   70.69    9.3   48.8   108  68995
## Montana          746   4347   0.6   70.56    5.0   59.2   155 145587
## Nebraska        1544   4508   0.6   72.60    2.9   59.3   139  76483
## Nevada           590   5149   0.5   69.03   11.5   65.2   188 109889
## New Hampshire    812   4281   0.7   71.23    3.3   57.6   174   9027
## New Jersey      7333   5237   1.1   70.93    5.2   52.5   115   7521
## New Mexico      1144   3601   2.2   70.32    9.7   55.2   120 121412
## New York       18076   4903   1.4   70.55   10.9   52.7    82  47831
## North Carolina  5441   3875   1.8   69.21   11.1   38.5    80  48798
## North Dakota     637   5087   0.8   72.78    1.4   50.3   186  69273
## Ohio           10735   4561   0.8   70.82    7.4   53.2   124  40975
## Oklahoma        2715   3983   1.1   71.42    6.4   51.6    82  68782
## Oregon          2284   4660   0.6   72.13    4.2   60.0    44  96184
## Pennsylvania   11860   4449   1.0   70.43    6.1   50.2   126  44966
## Rhode Island     931   4558   1.3   71.90    2.4   46.4   127   1049
## South Carolina  2816   3635   2.3   67.96   11.6   37.8    65  30225
## South Dakota     681   4167   0.5   72.08    1.7   53.3   172  75955
## Tennessee       4173   3821   1.7   70.11   11.0   41.8    70  41328
## Texas          12237   4188   2.2   70.90   12.2   47.4    35 262134
## Utah            1203   4022   0.6   72.90    4.5   67.3   137  82096
## Vermont          472   3907   0.6   71.64    5.5   57.1   168   9267
## Virginia        4981   4701   1.4   70.08    9.5   47.8    85  39780
## Washington      3559   4864   0.6   71.72    4.3   63.5    32  66570
## West Virginia   1799   3617   1.4   69.48    6.7   41.6   100  24070
## Wisconsin       4589   4468   0.7   72.48    3.0   54.5   149  54464
## Wyoming          376   4566   0.6   70.29    6.9   62.9   173  97203</code></pre>
<p>Then if we analyze this dataset using PCA method, the output can alse be shown in table as follows. All components’ sd and proprotion of variance were clear.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>state.pca <span class="ot">&lt;-</span> <span class="fu">princomp</span>(state.x77.df, <span class="at">cor=</span>T)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(state.pca,<span class="at">loadings=</span>F)</span></code></pre></div>
<pre><code>## Importance of components:
##                           Comp.1    Comp.2    Comp.3     Comp.4     Comp.5
## Standard deviation     1.8970755 1.2774659 1.0544862 0.84113269 0.62019488
## Proportion of Variance 0.4498619 0.2039899 0.1389926 0.08843803 0.04808021
## Cumulative Proportion  0.4498619 0.6538519 0.7928445 0.88128252 0.92936273
##                            Comp.6    Comp.7     Comp.8
## Standard deviation     0.55449226 0.3800642 0.33643379
## Proportion of Variance 0.03843271 0.0180561 0.01414846
## Cumulative Proportion  0.96779544 0.9858515 1.00000000</code></pre>
</div>
</div>
<div id="section-1" class="section level2">
<h2>09-23</h2>
</div>
<div id="question-3.4" class="section level2">
<h2>Question 3.4</h2>
<p>Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma\)</span> &gt; 0 and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span> (check the histogram).</p>
</div>
<div id="answer-3.4" class="section level2">
<h2>Answer 3.4</h2>
<p>Since the Rayleigh pdf is <span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/2\sigma^2}\)</span>, the cdf then is <span class="math inline">\(F(x)=1-e^{-x^2/2\sigma^2}\)</span>. Then <span class="math inline">\(F^{-1}(u)=\sqrt {-2\sigma^2ln(1-u)}\)</span>.</p>
<p>I took the inverse transform method to generate random samples along with histogram check as following, where <span class="math inline">\(\sigma\)</span> values are 1, 2 and 4.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma = 1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma = 2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">2</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,<span class="fl">0.01</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma = 4</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(sigma<span class="sc">==</span><span class="dv">4</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="fl">0.01</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>All histogram checks shows that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="question-3.11" class="section level2">
<h2>Question 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0, 1)\)</span> and <span class="math inline">\(N(3, 1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1-p_1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1 = 0.75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_1\)</span> that produce bimodal mixtures.</p>
</div>
<div id="answer-3.11" class="section level2">
<h2>Answer 3.11</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_1 = 0.75</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="cn">TRUE</span>,<span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> p<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>x2</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p_1<span class="sc">==</span><span class="fl">0.75</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_1 = 0.5</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="cn">TRUE</span>,<span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> p<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>x2</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p_1<span class="sc">==</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_1 = 0.6</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="cn">TRUE</span>,<span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> p<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>x2</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p_1<span class="sc">==</span><span class="fl">0.6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_1 = 0.65</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.65</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="cn">TRUE</span>,<span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> p<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>x2</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(p_1<span class="sc">==</span><span class="fl">0.65</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When <span class="math inline">\(p_1=0.5\)</span> or <span class="math inline">\(0.6\)</span>, the mixture is bimodal. When <span class="math inline">\(p_1=0.75\)</span> or <span class="math inline">\(0.65\)</span>, the mixture is not bimodal.</p>
<p>I think the mixture appears to be bimodal as long as <span class="math inline">\(p_1\)</span> value is not far from <span class="math inline">\(0.5\)</span>. When <span class="math inline">\(p_1\)</span> is too large or too small, i.e. far away from <span class="math inline">\(0.5\)</span>, the mixture would not be bimodal.</p>
</div>
<div id="question-3.11-1" class="section level2">
<h2>Question 3.11</h2>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t \geq 0\}\)</span> that can be represented as the random sum <span class="math inline">\(X(t) =\sum^ {N(t)}_ {i=1} Y_i\)</span>, <span class="math inline">\(t \geq 0\)</span>, where <span class="math inline">\(\{N(t), t \geq 0\}\)</span> is a Poisson process and <span class="math inline">\(Y_1, Y_2,...\)</span> are <span class="math inline">\(iid\)</span> and independent of <span class="math inline">\(\{N(t), t \geq 0\}\)</span>. Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)-Gamma process (<span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values.</p>
<p>Hint: Show that <span class="math inline">\(E[X(t)] = \lambda tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = \lambda tE[Y_1^2]\)</span></p>
</div>
<div id="answer-3.11-1" class="section level2">
<h2>Answer 3.11</h2>
<p>Let <span class="math inline">\(\{N(t), t \geq 0\} \sim Poisson(\lambda)\)</span> and <span class="math inline">\(Y\sim Gamma(r,\beta)\)</span>, where the values of <span class="math inline">\(\lambda,\)</span> <span class="math inline">\(r\)</span> and <span class="math inline">\(\beta\)</span> are 2, 4 and 3.</p>
<p>Then generate <span class="math inline">\(X\)</span> and plot its histogram as following.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lambda = 2, r = 4, beta = 3</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  N[i] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>i)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fu">max</span>(N),r,beta)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  X[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y[<span class="dv">1</span><span class="sc">:</span>N[i]])</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&#39;lambda = 2, r = 4, beta = 3&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math display">\[
E[X(t)]=E[\sum_{i=1}^{N(t)}Y_i]=EE[\sum_{i=1}^{N(t)}Y_i|N(t)]=EE[N(t)*E[Y_1]|N(t)]=E[N(t)]E[Y_1]=\lambda tE[Y_1],
\]</span> <span class="math display">\[
Var(X(t))=Var(E[\sum_{i=1}^{N(t)}Y_i|N(t)]) + E[Var(\sum_{i=1}^{N(t)}Y_i|N(t))]=Var(N(t)E[Y_1])+E[N(t)(EY_1^2-(EY_1)^2)]
\]</span> <span class="math display">\[
=\lambda t(EY_1)^2+\lambda tEY_1^2-\lambda t(EY_1)^2=\lambda tEY_1^2 .
\]</span></p>
<p>Then the theoretical mean and the variance of <span class="math inline">\(X(10)\)</span> are <span class="math inline">\(\lambda*10*\frac{r}{\beta}=26.7\)</span> and <span class="math inline">\(\lambda*10*(\frac{r}{\beta^2}+(\frac{r}{\beta})^2)=44.4\)</span></p>
<p>While their estimates can be got using real mean and variance of <span class="math inline">\(Y_1,Y_2,...\)</span> as follows.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>E2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>E <span class="co"># estimate mean</span></span></code></pre></div>
<pre><code>## [1] 26.37981</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>E2 <span class="co"># estimate variance</span></span></code></pre></div>
<pre><code>## [1] 43.86597</code></pre>
<div id="lamda-4-r-8-and-beta-6" class="section level4">
<h4>lamda = 4, r = 8 and beta = 6</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  N[i] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>i)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fu">max</span>(N),r,beta)</span></code></pre></div>
<p>Then the theoretical mean and the variance of <span class="math inline">\(X(10)\)</span> are <span class="math inline">\(\lambda*10*\frac{r}{\beta}=53.3\)</span> and <span class="math inline">\(\lambda*10*(\frac{r}{\beta^2}+(\frac{r}{\beta})^2)=80\)</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>E2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>E <span class="co"># estimate mean</span></span></code></pre></div>
<pre><code>## [1] 54.05946</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>E2 <span class="co"># estimate variance</span></span></code></pre></div>
<pre><code>## [1] 82.32137</code></pre>
</div>
<div id="lamda-4-r-2-and-beta-4" class="section level4">
<h4>lamda = 4, r = 2 and beta = 4</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  N[i] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>i)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fu">max</span>(N),r,beta)</span></code></pre></div>
<p>Then the theoretical mean and the variance of <span class="math inline">\(X(10)\)</span> are <span class="math inline">\(\lambda*10*\frac{r}{\beta}=20\)</span> and <span class="math inline">\(\lambda*10*(\frac{r}{\beta^2}+(\frac{r}{\beta})^2)=15\)</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>E2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>E <span class="co"># estimate mean</span></span></code></pre></div>
<pre><code>## [1] 20.33887</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>E2 <span class="co"># estimate variance</span></span></code></pre></div>
<pre><code>## [1] 15.37331</code></pre>
</div>
</div>
<div id="section-2" class="section level2">
<h2>09-30</h2>
</div>
<div id="question-5.4" class="section level2">
<h2>Question 5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for x = 0.1, 0.2,…, 0.9. Compare the estimates with the values returned by the <span class="math inline">\(pbeta\)</span> function in R.</p>
</div>
<div id="answer-5.4" class="section level2">
<h2>Answer 5.4</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x){x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)}</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e4</span>, <span class="dv">0</span>, x)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">*</span><span class="fu">mean</span>(<span class="fu">pdf</span>(U)))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>MC <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(x))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  MC[i] <span class="ot">&lt;-</span> <span class="fu">cdf</span>(x[i])</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x, MC, B), <span class="dv">9</span>))</span></code></pre></div>
<pre><code>##           [,1]       [,2]      [,3]      [,4]      [,5]      [,6]     [,7]
## x  0.100000000 0.20000000 0.3000000 0.4000000 0.5000000 0.6000000 0.700000
## MC 0.008592357 0.05795302 0.1610569 0.3182425 0.5054814 0.6801827 0.838533
## B  0.008560000 0.05792000 0.1630800 0.3174400 0.5000000 0.6825600 0.836920
##         [,8]      [,9]
## x  0.8000000 0.9000000
## MC 0.9378992 0.9822031
## B  0.9420800 0.9914400</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MC is estimate, B is real</span></span></code></pre></div>
<p>The estimates and real value are very close.</p>
</div>
<div id="question-5.9" class="section level2">
<h2>Question 5.9</h2>
<p>Implement a function to generate samples from a <span class="math inline">\(Rayleigh(\sigma)\)</span> distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1, X_2\)</span>?</p>
</div>
<div id="answer-5.9" class="section level2">
<h2>Answer 5.9</h2>
<p>Let <span class="math inline">\(\sigma=1\)</span>, <span class="math inline">\(f(x)=xe^{- \frac{x^2}{2}}\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>MC.Phi <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic) v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>) <span class="cf">else</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> x[i] <span class="sc">*</span>u<span class="sc">*</span>x[i]<span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(u <span class="sc">*</span> x[i])<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    cdf[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g) <span class="sc">+</span> <span class="fl">0.5</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(x, <span class="at">anti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>MC2 <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(x)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">var</span>(MC2)<span class="sc">-</span><span class="fu">var</span>(MC1))<span class="sc">/</span><span class="fu">var</span>(MC1)</span></code></pre></div>
<pre><code>## [1] 0.01331673</code></pre>
<p>The variance is reduced by 1.33%.</p>
</div>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on x &gt; 1 and are ‘close’ to <span class="math display">\[
g(x) = \frac{x^2}{\sqrt {2\pi}}e^{-x^2/2}
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt {2\pi}}e^{-x^2/2}dx
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-5.13" class="section level2">
<h2>Answer 5.13</h2>
<p>I choose <span class="math display">\[
f_1(x)=\frac{2}{\sqrt {2\pi}}e^{-(x-1)^2/2}
\]</span> and <span class="math display">\[
f_2(x)=e^{-x}
\]</span></p>
<p>Clearly <span class="math inline">\(f_1(x)\)</span> is closer to <span class="math inline">\(g(x)\)</span>. As a result <span class="math inline">\(f_1\)</span> would produce smaller variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt {2\pi}}e^{-x^2/2}dx.
\]</span></p>
</div>
<div id="question-5.14" class="section level2">
<h2>Question 5.14</h2>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt {2\pi}}e^{-x^2/2}dx
\]</span> by importance sampling.</p>
</div>
<div id="answer-5.14" class="section level2">
<h2>Answer 5.14</h2>
<p>I choose <span class="math inline">\(f_2(x)=e^{-x}\)</span> to be the importance function. <span class="math inline">\(F_2(x)=1-e^{-x}\)</span>,<span class="math inline">\(F^{-1}(u)=-ln(1-u)\)</span>,</p>
<p><span class="math inline">\(g(x)/f_2(x)=\frac{x^2}{\sqrt {2\pi}}e^{-x^2/2+x}\)</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e4</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fl">3.14</span>)<span class="sc">^</span><span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(X<span class="sc">-</span>X<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Y)</span></code></pre></div>
<pre><code>## [1] 0.4993853</code></pre>
</div>
<div id="section-3" class="section level2">
<h2>10-14</h2>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6.5" class="section level2">
<h2>Answer 6.5</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">20</span>,<span class="dv">2</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(X,<span class="at">mu=</span><span class="dv">2</span>,<span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  X
## t = 0.56566, df = 19, p-value = 0.5782
## alternative hypothesis: true mean is not equal to 2
## 95 percent confidence interval:
##  1.250399 3.304838
## sample estimates:
## mean of x 
##  2.277618</code></pre>
<p>The 0.95 confidence interval is (1.217898, 2.302909).</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="fl">1e4</span>,<span class="dv">2</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>) {</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  Z[i] <span class="ot">&lt;-</span> (Y[i]<span class="sc">&gt;</span> <span class="fl">1.250399</span><span class="sc">&amp;&amp;</span>Y[i]<span class="sc">&lt;</span><span class="fl">3.304838</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Z) <span class="co">#coverage probability</span></span></code></pre></div>
<pre><code>## [1] 0.3521</code></pre>
<p>The probability that the confidence interval covers the mean is not equal to 0.95.</p>
<p>As to 6.4,</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(X,<span class="at">mu=</span><span class="dv">0</span>,<span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  X
## t = 0.93298, df = 19, p-value = 0.3625
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -0.2368920  0.6179398
## sample estimates:
## mean of x 
## 0.1905239</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e4</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>) {</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  Z[i] <span class="ot">&lt;-</span> (Y[i]<span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">0.2368920</span><span class="sc">&amp;&amp;</span>Y[i]<span class="sc">&lt;</span><span class="fl">0.6179398</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Z) <span class="co">#coverage probability</span></span></code></pre></div>
<pre><code>## [1] 0.325</code></pre>
<p>The results are similar.</p>
</div>
<div id="question-6.a" class="section level2">
<h2>Question 6.A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0 : \mu = \mu_0\)</span> vs <span class="math inline">\(H_1 : \mu \neq \mu_0\)</span>, where <span class="math inline">\(mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-6.a" class="section level2">
<h2>Answer 6.A</h2>
<div id="i" class="section level3">
<h3>(i)</h3>
<p><span class="math inline">\(X\)</span> from <span class="math inline">\(\chi^2(1)\)</span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fl">1e4</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">t.test</span>(X,<span class="at">mu =</span> <span class="dv">1</span> ,<span class="at">conf.level =</span> <span class="fl">0.9</span>) <span class="co">#alpha = 0.1</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  p[i] <span class="ot">&lt;-</span> a<span class="sc">$</span>p.value</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p<span class="sc">&lt;=</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1807</code></pre>
<p>Type I error rate of the t-test is bigger than <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="ii" class="section level3">
<h3>(ii)</h3>
<p><span class="math inline">\(X\)</span> from <span class="math inline">\(Uniform(0,2)\)</span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fl">1e4</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>) {</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">t.test</span>(X,<span class="at">mu =</span> <span class="dv">1</span>,<span class="at">conf.level =</span> <span class="fl">0.9</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  p[i] <span class="ot">&lt;-</span> a<span class="sc">$</span>p.value</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p<span class="sc">&lt;=</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 0.102</code></pre>
<p>Type I error rate of the t-test is approximately equal to <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="ii-1" class="section level3">
<h3>(ii)</h3>
<p><span class="math inline">\(X\)</span> from <span class="math inline">\(Exponential(1)\)</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fl">1e4</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>) {</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">t.test</span>(X,<span class="at">mu =</span> <span class="dv">1</span>,<span class="at">conf.level =</span> <span class="fl">0.9</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  p[i] <span class="ot">&lt;-</span> a<span class="sc">$</span>p.value</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p<span class="sc">&lt;=</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1557</code></pre>
<p>Type I error rate of the t-test is bigger than <span class="math inline">\(\alpha\)</span>.</p>
</div>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>This is a hypothesis test problem about testing whether two benoulli’s p is equal or not.</p>
<p>We now have 10000 sample datasets for each of them and their sample <span class="math inline">\(p\)</span>s, 0.651 and 0.676.</p>
<p>As a result, we can use two-sample t-test to finish this hypothesis test problem.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6510</span>),<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3490</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6760</span>),<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3240</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(X,Y)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  X and Y
## t = -3.7423, df = 19991, p-value = 0.0001828
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.03809399 -0.01190601
## sample estimates:
## mean of x mean of y 
##     0.651     0.676</code></pre>
<p>From p-value = 0.0001828 we can come to the conclusion that in 0.99 level these 2 powers are different.</p>
</div>
<div id="section-4" class="section level2">
<h2>10-21</h2>
</div>
<div id="question-of-example-6.8" class="section level2">
<h2>Question of Example 6.8</h2>
<p>Assess the Type <span class="math inline">\(I\)</span> error rate for a skewness test of normality at <span class="math inline">\(\alpha\)</span> = 0.05 based on the asymptotic distribution of <span class="math inline">\(b_{1,d}\)</span> for sample sizes n = 10, 20, 30, 50, 100, and 500.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span> ,<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">95</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">/</span>n <span class="co">#crit. values for each n</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>b1d <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#computes the multivariate skewness statistic</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  x.bar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  x.bar.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(x.bar,n),<span class="at">ncol =</span> n,<span class="at">nrow =</span> d)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  x.bar.matrix <span class="ot">&lt;-</span> <span class="fu">t</span>(x.bar.matrix)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> ((x<span class="sc">-</span>x.bar.matrix) <span class="sc">%*%</span> <span class="fu">solve</span>(sigma.hat) <span class="sc">%*%</span> <span class="fu">t</span>(x<span class="sc">-</span>x.bar.matrix))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">mean</span>(b)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>x.gener <span class="ot">&lt;-</span> <span class="cf">function</span>(d,n){</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#x generation process</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,d)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> d,<span class="at">ncol =</span> d)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d) {</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    sigma[i,i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mean, sigma)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p.reject &lt;- numeric(length(n)) #to store sim. results</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#m &lt;- 10000</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:length(n)) {</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  sktests &lt;- numeric(m) #test decisions</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (j in 1:m) {</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    x &lt;- x.gener(d,n[i])</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">#    #test decision is 1 (reject) or 0</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">#    sktests[j] &lt;- as.integer(abs(b1d(x)) &gt;= cv[i] )</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.reject[i] &lt;- mean(sktests) #proportion rejected</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co">#p.reject</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co">#corresponding to n = 10, 20, 30, 50, 100, 500</span></span></code></pre></div>
<p>The results of the simulation suggest that the asymptotic normal approximation for the distribution of <span class="math inline">\(b_{1,d}\)</span> is not adequate when sample sizes is small. As the sample size is large enough, the Type <span class="math inline">\(I\)</span> error rate is close to 0.05.</p>
</div>
<div id="question-of-example-6.10" class="section level2">
<h2>Question of Example 6.10</h2>
<p>In this example, we estimate by simulation the power of the skewness test of normality against a contaminated normal (normal scale mixture) alternative described in Example 6.3</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(1)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">#alpha &lt;- .1</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#n &lt;- 500</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">#d &lt;- 3</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#m &lt;- 2500</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">#epsilon &lt;- c(seq(0, .15, .01), seq(.15, 1, .05))</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">#N &lt;- length(epsilon)</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">#pwr &lt;- numeric(N)</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="do">##critical value for the skewness test</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#cv &lt;- cv &lt;- qchisq(.95, d*(d+1)*(d+2)/6)*6/n</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co">#for (j in 1:N) { #for each epsilon</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  e &lt;- epsilon[j]</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  sktests &lt;- numeric(m)</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (i in 1:m) { #for each replicate</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    sigma1 &lt;- diag(rep(1,d))</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    sigma2 &lt;- diag(rep(10,d))</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="co">#    mean &lt;- rep(0,d)</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co">#    x1 &lt;- mvrnorm(n, mean, sigma1)</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co">#    x2 &lt;- mvrnorm(n, mean, sigma2)</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co">#    p &lt;- sample(c(1,0),replace = TRUE, size = n*d,prob = c(1-e,e))</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="co">#    x &lt;- x1*p+x2*(1-p)</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="co">#    sktests[i] &lt;- as.integer(abs(b1d(x)) &gt;= cv)</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  } </span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  pwr[j] &lt;- mean(sktests)</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="do">##plot power vs epsilon</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(epsilon, pwr, type = &quot;b&quot;,</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="co">#xlab = bquote(epsilon), ylim = c(0,0.8))</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="do">##abline(h = .1, lty = 3)</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a><span class="co">#se &lt;- sqrt(pwr * (1-pwr) / m) #add standard errors</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="co">#lines(epsilon, pwr+se, lty = 3)</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a><span class="co">#lines(epsilon, pwr-se, lty = 3)</span></span></code></pre></div>
<p>When <span class="math inline">\(\epsilon = 0\)</span> or <span class="math inline">\(\epsilon = 1\)</span>, power is very low because the alternative is normally distributed. For <span class="math inline">\(0&lt;\epsilon&lt;1\)</span> the empirical power of the test is greater than 0.01 and highest when <span class="math inline">\(\epsilon\)</span> is about 0.17.</p>
</div>
<div id="section-5" class="section level2">
<h2>10-28</h2>
</div>
<div id="question-7.7" class="section level2">
<h2>Question 7.7</h2>
<p>The five-dimensional scores data have a <span class="math inline">\(5 \times 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1 &gt; ... &gt; \lambda_5\)</span>. In principal components analysis, <span class="math display">\[\theta=\frac{\lambda_1}{\sum_{j=1}^5\lambda_j}\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat λ_1 &gt; ··· &gt; \hat λ_5\)</span> be the eigenvalues of <span class="math inline">\(\hat \Sigma\)</span>, where <span class="math inline">\(\hat \Sigma\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[\hat \theta=\frac{\hat \lambda_1}{\sum_{j=1}^5\hat \lambda_j}\]</span></p>
</div>
<div id="answer-7.7" class="section level2">
<h2>Answer 7.7</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>lambda.hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat)<span class="sc">$</span>values</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat \theta\)</span>.</p>
</div>
<div id="answer-7.8" class="section level2">
<h2>Answer 7.8</h2>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(scor))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(scor)) {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i,]</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(data)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma)<span class="sc">$</span>values</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(scor)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>bias</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">nrow</span>(scor)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>se</span></code></pre></div>
<pre><code>## [1] 0.04955244</code></pre>
</div>
<div id="question-7.9" class="section level2">
<h2>Question 7.9</h2>
<p>Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat \theta\)</span>.</p>
</div>
<div id="answer-7.9" class="section level2">
<h2>Answer 7.9</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="cf">function</span>(data,indices){</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices,]</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(d)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  lambda.hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat)<span class="sc">$</span>values</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  theta.hat <span class="ot">&lt;-</span> lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta.hat)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> scor, <span class="at">statistic =</span> theta, <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(result,<span class="at">conf =</span> <span class="fl">0.95</span>,<span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = result, conf = 0.95, type = &quot;bca&quot;)
## 
## Intervals : 
## Level       BCa          
## 95%   ( 0.5234,  0.7035 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="question-7.b" class="section level2">
<h2>Question 7.B</h2>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).</p>
</div>
<div id="answer-7.b" class="section level2">
<h2>Answer 7.B</h2>
<div id="normal-populations" class="section level4">
<h4>Normal populations</h4>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(data,indices) {</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span> )</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>getbc <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> x,<span class="at">statistic =</span> sk,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  bc <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(result,<span class="at">conf =</span> <span class="fl">0.95</span>,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  norm.ci <span class="ot">&lt;-</span> <span class="fu">c</span>(bc<span class="sc">$</span>normal[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  basic.ci <span class="ot">&lt;-</span> <span class="fu">c</span>(bc<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  percent.ci <span class="ot">&lt;-</span> <span class="fu">c</span>(bc<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  matri <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rbind</span>(<span class="fu">rbind</span>(norm.ci, basic.ci),percent.ci))</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(matri)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Monte Carlo progress</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co">#norm.cr &lt;- numeric(1000)</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#basic.cr &lt;- numeric(1000)</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">#percent.cr &lt;- numeric(1000)</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:1000) {</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(100)</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  ci &lt;- getbc(x)</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  norm.cr[i] &lt;- as.integer(0 &lt; ci[1,2]&amp;0 &gt; ci[1,1])</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  basic.cr[i] &lt;- as.integer(0 &lt; ci[2,2]&amp;0 &gt; ci[2,1])</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  percent.cr[i] &lt;- as.integer(0 &lt; ci[3,2]&amp;0 &gt; ci[3,1])</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="co">#norm.cr &lt;- mean(norm.cr)</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co">#norm.cr #coverage probabilities of the standard normal bootstrap confidence interval</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#basic.cr &lt;- mean(basic.cr)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co">#basic.cr #coverage probabilities of the basic bootstrap confidence interval</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#percent.cr &lt;- mean(percent.cr)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">#percent.cr #coverage probabilities of the percentile confidence interval</span></span></code></pre></div>
</div>
<div id="chi25-distributions" class="section level4">
<h4>chi^2(5) distributions</h4>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Monte Carlo progress</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#norm.cr &lt;- numeric(1000)</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#basic.cr &lt;- numeric(1000)</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#percent.cr &lt;- numeric(1000)</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:1000) {</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rchisq(100,df=5)</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  ci &lt;- getbc(x)</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  norm.cr[i] &lt;- as.integer(sqrt(8/5) &lt; ci[1,2]&amp; sqrt(8/5) &gt; ci[1,1])</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  basic.cr[i] &lt;- as.integer(sqrt(8/5) &lt; ci[2,2]&amp; sqrt(8/5) &gt; ci[2,1])</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  percent.cr[i] &lt;- as.integer(sqrt(8/5) &lt; ci[3,2]&amp; sqrt(8/5) &gt; ci[3,1])</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co">#norm.cr &lt;- mean(norm.cr)</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co">#norm.cr #coverage probabilities of the standard normal bootstrap confidence interval</span></span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#basic.cr &lt;- mean(basic.cr)</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">#basic.cr #coverage probabilities of the basic bootstrap confidence interval</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#percent.cr &lt;- mean(percent.cr)</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#percent.cr #coverage probabilities of the percentile confidence interval</span></span></code></pre></div>
</div>
</div>
<div id="section-6" class="section level2">
<h2>11-04</h2>
</div>
<div id="question-8.2" class="section level2">
<h2>Question 8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-8.2" class="section level2">
<h2>Answer 8.2</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## [1] -0.007488749</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = -0.32846, df = 98, p-value = 0.7433
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.2280941  0.1643268
## sample estimates:
##         cor 
## -0.03316168</code></pre>
<p>The significance level of the permutation test using cor with method = “spearman” is similar to the p-value reported by cor.test.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question *</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer *</h2>
<div id="unequal-variances-and-equal-expectations" class="section level4">
<h4>(1)Unequal variances and equal expectations</h4>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NN method</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> z[ix, ]</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn &lt;- numeric(length = 200)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {# monte carlo</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(30,0,1)</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(30,0,2)</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x, y)</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  boot.obj &lt;- boot(data = z, statistic = Tn, R = 999,</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    sim = &quot;permutation&quot;, sizes = N,k=3)</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  ts &lt;- c(boot.obj$t0,boot.obj$t)</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value &lt;- mean(ts&gt;=ts[1])</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.nn[i] &lt;- as.integer(p.value&lt;0.05)</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn &lt;- mean(pow.nn)</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn #power of NN test</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># energy test</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(energy)</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy &lt;- numeric(length = 200)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(30,0,1)</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(30,0,2)</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x,y)</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  boot.obs &lt;- eqdist.etest(z, sizes=N, R=999)</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value &lt;- boot.obs$p.value</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.energy[i] &lt;- as.integer(p.value&lt;0.05)</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy &lt;- mean(pow.energy)</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy # power of energy test</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ball method</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(Ball)</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball &lt;- numeric(length = 200)</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(30,0,1)</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(30,0,2)</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x,y)</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value = bd.test(x = x, y = y, num.permutations=999)$p.value</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.ball[i] &lt;- as.integer(as.numeric(p.value)&lt;0.05)</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball &lt;- mean(pow.ball)</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball # power of ball method</span></span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data.frame(pow.nn,pow.energy,pow.ball)</span></span></code></pre></div>
</div>
<div id="unequal-variances-and-unequal-expectations" class="section level4">
<h4>(2)Unequal variances and unequal expectations</h4>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NN method</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn &lt;- numeric(length = 200)</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {# monte carlo</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(30,0,1)</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(30,0.5,2)</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x, y)</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  boot.obj &lt;- boot(data = z, statistic = Tn, R = 999,</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    sim = &quot;permutation&quot;, sizes = N,k=3)</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  ts &lt;- c(boot.obj$t0,boot.obj$t)</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value &lt;- mean(ts&gt;=ts[1])</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.nn[i] &lt;- as.integer(p.value&lt;0.05)</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn &lt;- mean(pow.nn)</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn #power of NN test</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># energy test</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy &lt;- numeric(length = 200)</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(30,0,1)</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(30,0.5,2)</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x,y)</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  boot.obs &lt;- eqdist.etest(z, sizes=N, R=999)</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value &lt;- boot.obs$p.value</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.energy[i] &lt;- as.integer(p.value&lt;0.05)</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy &lt;- mean(pow.energy)</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy # power of energy test</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ball method</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball &lt;- numeric(length = 200)</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(30,0,1)</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(30,0.5,2)</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x,y)</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value = bd.test(x = x, y = y, num.permutations=999)$p.value</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.ball[i] &lt;- as.integer(as.numeric(p.value)&lt;0.05)</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball &lt;- mean(pow.ball)</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball # power of ball method</span></span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data.frame(pow.nn,pow.energy,pow.ball)</span></span></code></pre></div>
</div>
<div id="non-normal-distributions-t-distribution-with-1-df-bimodel-distribution" class="section level4">
<h4>(3)Non-normal distributions: t distribution with 1 df, bimodel distribution</h4>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NN method</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn &lt;- numeric(length = 200)</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {# monte carlo</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rt(30,df=1)</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y1 &lt;- rnorm(30,0,1)</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  y2 &lt;- rnorm(30,0,2)</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  p &lt;- sample(c(0,1),size = 1)</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- p*y1+(1-p)*y2</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x, y)</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  boot.obj &lt;- boot(data = z, statistic = Tn, R = 999,</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">#    sim = &quot;permutation&quot;, sizes = N,k=3)</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  ts &lt;- c(boot.obj$t0,boot.obj$t)</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value &lt;- mean(ts&gt;=ts[1])</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.nn[i] &lt;- as.integer(p.value&lt;0.05)</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn &lt;- mean(pow.nn)</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn #power of NN test</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># energy test</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy &lt;- numeric(length = 200)</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:1000) {</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rt(30,df=1)</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y1 &lt;- rnorm(30,0,1)</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  y2 &lt;- rnorm(30,0,2)</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  p &lt;- sample(c(0,1),size = 1)</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- p*y1+(1-p)*y2</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x,y)</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  boot.obs &lt;- eqdist.etest(z, sizes=N, R=999)</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value &lt;- boot.obs$p.value</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.energy[i] &lt;- as.integer(p.value&lt;0.05)</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy &lt;- mean(pow.energy)</span></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy # power of energy test</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ball method</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball &lt;- numeric(length = 200)</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:1000) {</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rt(30,df=1)</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y1 &lt;- rnorm(30,0,1)</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  y2 &lt;- rnorm(30,0,2)</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  p &lt;- sample(c(0,1),size = 1)</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- p*y1+(1-p)*y2</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x,y)</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value = bd.test(x = x, y = y, num.permutations=999)$p.value</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.ball[i] &lt;- as.integer(as.numeric(p.value)&lt;0.05)</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball &lt;- mean(pow.ball)</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball # power of ball method</span></span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data.frame(pow.nn,pow.energy,pow.ball)</span></span></code></pre></div>
</div>
<div id="unbalanced-samples" class="section level4">
<h4>(4)Unbalanced samples</h4>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NN method</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn &lt;- numeric(length = 200)</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {# monte carlo</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(10,0,1)</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(50,1,2)</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x, y)</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  boot.obj &lt;- boot(data = z, statistic = Tn, R = 999,</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    sim = &quot;permutation&quot;, sizes = N,k=3)</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  ts &lt;- c(boot.obj$t0,boot.obj$t)</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value &lt;- mean(ts&gt;=ts[1])</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.nn[i] &lt;- as.integer(p.value&lt;0.05)</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn &lt;- mean(pow.nn)</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.nn #power of NN test</span></span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># energy test</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy &lt;- numeric(length = 200)</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(10,0,1)</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(50,1,2)</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x,y)</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  boot.obs &lt;- eqdist.etest(z, sizes=N, R=999)</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value &lt;- boot.obs$p.value</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.energy[i] &lt;- as.integer(p.value&lt;0.05)</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy &lt;- mean(pow.energy)</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.energy # power of energy test</span></span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ball method</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball &lt;- numeric(length = 200)</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:200) {</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(10,0,1)</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- rnorm(50,1,2)</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  z &lt;- c(x,y)</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- c(length(x), length(y))</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  p.value = bd.test(x = x, y = y, num.permutations=999)$p.value</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  pow.ball[i] &lt;- as.integer(as.numeric(p.value)&lt;0.05)</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball &lt;- mean(pow.ball)</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="co">#pow.ball # power of ball method</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data.frame(pow.nn,pow.energy,pow.ball)</span></span></code></pre></div>
<p>Overall, the performance of Ball methods is the best, while the performance of NN method is not as good as other 2 methods.</p>
</div>
</div>
<div id="section-7" class="section level2">
<h2>11-11</h2>
</div>
<div id="question-9.3" class="section level2">
<h2>Question 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1).</p>
</div>
<div id="answer-9.3" class="section level2">
<h2>Answer 9.3</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="co"># target pdf</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b){<span class="co">#g(a|b), proposal pdf</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">dnorm</span>(a,b))</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">10000</span>)</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">16000</span>) {</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,X[i<span class="dv">-1</span>])</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fu">f</span>(Y)<span class="sc">*</span><span class="fu">g</span>(X[i<span class="dv">-1</span>],Y)<span class="sc">/</span>(<span class="fu">f</span>(X[i<span class="dv">-1</span>])<span class="sc">*</span><span class="fu">g</span>(Y,X[i<span class="dv">-1</span>]))</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(U<span class="sc">&lt;=</span>alpha)X[i] <span class="ot">&lt;-</span> Y <span class="cf">else</span> X[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]</span></code></pre></div>
<p>Comparing deciles:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">qt=</span><span class="fu">qt</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>,<span class="at">df=</span><span class="dv">1</span>),<span class="at">X=</span><span class="fu">quantile</span>(X, <span class="at">probs =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0.1&quot;</span>,<span class="st">&quot;0.2&quot;</span>,<span class="st">&quot;0.3&quot;</span>,<span class="st">&quot;0.4&quot;</span>,<span class="st">&quot;0.5&quot;</span>,<span class="st">&quot;0.6&quot;</span>,<span class="st">&quot;0.7&quot;</span>,<span class="st">&quot;0.8&quot;</span>,<span class="st">&quot;0.9&quot;</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##             qt           X
## 0.1 -3.0776835 -3.52350290
## 0.2 -1.3763819 -1.42558005
## 0.3 -0.7265425 -0.74329871
## 0.4 -0.3249197 -0.33813613
## 0.5  0.0000000 -0.01746655
## 0.6  0.3249197  0.27091854
## 0.7  0.7265425  0.61403023
## 0.8  1.3763819  1.19396517
## 0.9  3.0776835  2.51046712</code></pre>
<p>Their deciles are similar.</p>
</div>
<div id="question-9.8" class="section level2">
<h2>Question 9.8</h2>
<p>Consider the bivariate density <span class="math display">\[f(x,y)\approx(_x^n)y^{x+a-1}(1-y)^{n-x+b-1},x=0,1...,n,0\leq y\leq 1\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).</p>
</div>
<div id="answer-9.8" class="section level2">
<h2>Answer 9.8</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  Y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X[i<span class="dv">-1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>X[i<span class="dv">-1</span>]<span class="sc">+</span>b)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  X[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,Y[i])</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Select 10 units to display as follows.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">X=</span>X[<span class="dv">701</span><span class="sc">:</span><span class="dv">710</span>],<span class="at">Y=</span>Y[<span class="dv">701</span><span class="sc">:</span><span class="dv">710</span>])</span></code></pre></div>
<pre><code>##    X         Y
## 1  3 0.6655227
## 2  2 0.4938351
## 3  2 0.2477856
## 4  5 0.6495848
## 5  2 0.6678237
## 6  2 0.5624496
## 7  1 0.3919249
## 8  1 0.1986792
## 9  1 0.2545175
## 10 2 0.2225551</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question *</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span></p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer *</h2>
<div id="section-8" class="section level4">
<h4>9.3</h4>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k chains</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># n units each chain</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>getX <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n,<span class="at">ncol =</span> k) <span class="co"># one colomn is one chain</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    X[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>      Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,X[j<span class="dv">-1</span>,i])</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>      U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>      alpha <span class="ot">&lt;-</span> <span class="fu">f</span>(Y)<span class="sc">*</span><span class="fu">g</span>(X[j<span class="dv">-1</span>,i],Y)<span class="sc">/</span>(<span class="fu">f</span>(X[j<span class="dv">-1</span>,i])<span class="sc">*</span><span class="fu">g</span>(Y,X[j<span class="dv">-1</span>,i]))</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(U<span class="sc">&lt;=</span>alpha)X[j,i] <span class="ot">&lt;-</span> Y <span class="cf">else</span> X[j,i] <span class="ot">&lt;-</span> X[j<span class="dv">-1</span>,i] </span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># phi_in is X[,i]</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># phi_i,j is X[j,i]</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>getR.hat <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">getX</span>(n)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  Xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  Bn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    Bn <span class="ot">&lt;-</span> Bn <span class="sc">+</span> (<span class="fu">mean</span>(X[,i])<span class="sc">-</span>Xbar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  Bn <span class="ot">&lt;-</span> n<span class="sc">*</span>Bn<span class="sc">/</span>(k<span class="dv">-1</span>)</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  Wn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>      Wn <span class="ot">&lt;-</span> Wn <span class="sc">+</span> (X[j,i]<span class="sc">-</span><span class="fu">mean</span>(X[,i]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>  Wn <span class="ot">&lt;-</span> Wn<span class="sc">/</span>n<span class="sc">/</span>k</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>  var.hat <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>Wn<span class="sc">/</span>n <span class="sc">+</span> Bn<span class="sc">/</span>n</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>  R.hat <span class="ot">&lt;-</span> var.hat<span class="sc">/</span>Wn</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(R.hat)</span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getR.hat</span>(<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 1.8138</code></pre>
<p><span class="math inline">\(\hat R\)</span> is smaller than 1.2, so the chain converges.</p>
</div>
<div id="section-9" class="section level4">
<h4>9.8</h4>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span>   <span class="co"># k chains</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># n units each chain</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>n. <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n,<span class="at">ncol =</span> k) <span class="co"># one colomn is one chain</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n,<span class="at">ncol =</span> k) <span class="co"># one colomn is one chain</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  Y[<span class="dv">1</span>,j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>    Y[i,j] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X[i<span class="dv">-1</span>,j]<span class="sc">+</span>a,n.<span class="sc">-</span>X[i<span class="dv">-1</span>,j]<span class="sc">+</span>b)</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    X[i,j] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n.,Y[i,j])</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Monitoring X:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>Xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>Bn.X <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  Bn.X <span class="ot">&lt;-</span> Bn.X <span class="sc">+</span> (<span class="fu">mean</span>(X[,i])<span class="sc">-</span>Xbar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>Bn.X <span class="ot">&lt;-</span> n<span class="sc">*</span>Bn.X<span class="sc">/</span>(k<span class="dv">-1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>Wn.X <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    Wn.X <span class="ot">&lt;-</span> Wn.X <span class="sc">+</span> (X[j,i]<span class="sc">-</span><span class="fu">mean</span>(X[,i]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>Wn.X <span class="ot">&lt;-</span> Wn.X<span class="sc">/</span>n<span class="sc">/</span>k</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>var.hat.X <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>Wn.X<span class="sc">/</span>n <span class="sc">+</span> Bn.X<span class="sc">/</span>n</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>R.hat.X <span class="ot">&lt;-</span> var.hat.X<span class="sc">/</span>Wn.X</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>R.hat.X</span></code></pre></div>
<pre><code>## [1] 1.03295</code></pre>
<p><span class="math inline">\(\hat R_X\)</span> is smaller than 1.2, so the chain converges.</p>
<p>Monitoring Y:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span> (<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>Ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>Bn.Y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  Bn.Y <span class="ot">&lt;-</span> Bn.Y <span class="sc">+</span> (<span class="fu">mean</span>(Y[,i])<span class="sc">-</span>Ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>Bn.Y <span class="ot">&lt;-</span> n<span class="sc">*</span>Bn.Y<span class="sc">/</span>(k<span class="dv">-1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>Wn.Y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    Wn.Y <span class="ot">&lt;-</span> Wn.Y <span class="sc">+</span> (Y[j,i]<span class="sc">-</span><span class="fu">mean</span>(Y[,i]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>Wn.Y <span class="ot">&lt;-</span> Wn.Y<span class="sc">/</span>n<span class="sc">/</span>k</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>var.hat.Y <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>Wn.Y<span class="sc">/</span>n <span class="sc">+</span> Bn.Y<span class="sc">/</span>n</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>R.hat.Y <span class="ot">&lt;-</span> var.hat.Y<span class="sc">/</span>Wn.Y</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>R.hat.Y</span></code></pre></div>
<pre><code>## [1] 1.019416</code></pre>
<p><span class="math inline">\(\hat R_Y\)</span> is smaller than 1.2, so the chain converges.</p>
</div>
</div>
<div id="section-10" class="section level2">
<h2>11-18</h2>
</div>
<div id="question-11.3" class="section level2">
<h2>Question 11.3</h2>
<p>(a)Write a function to compute the kth term in a sum function, where d <span class="math inline">\(\geq\)</span> 1 is an integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(|·|\)</span>denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large k and d. (This sum converges for all <span class="math inline">\(a \in R^d\)</span>)</p>
<p>(b)Modify the function so that it computes and returns the sum.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Evaluate the sum when <span class="math inline">\(a = (1, 2)^T\)</span></li>
</ol>
</div>
<div id="answer-11.3" class="section level2">
<h2>Answer 11.3</h2>
<div id="a" class="section level4">
<h4>(a)</h4>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>fk <span class="ot">&lt;-</span> <span class="cf">function</span>(k,d,a){</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(   (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>( <span class="fu">log</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(k<span class="sc">+</span><span class="dv">1</span>))<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">^</span>k)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>) )    )</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let k=10, d=5, a= rep(1,5)</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fk</span>(<span class="dv">10</span>,<span class="dv">5</span>,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>))</span></code></pre></div>
<pre><code>## [1] 3.957193e-07</code></pre>
<p>Let k=50, d=10, a= rep(1,10)</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fk</span>(<span class="dv">50</span>,<span class="dv">10</span>,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>))</span></code></pre></div>
<pre><code>## [1] 2.532068e-39</code></pre>
<p>Let k=100, d=20, a= rep(1,20)</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fk</span>(<span class="dv">100</span>,<span class="dv">20</span>,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>))</span></code></pre></div>
<pre><code>## [1] 3.527969e-75</code></pre>
<p>Let k=200, d=30, a= rep(1,30)</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fk</span>(<span class="dv">200</span>,<span class="dv">30</span>,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">30</span>))</span></code></pre></div>
<pre><code>## [1] 3.145816e-166</code></pre>
</div>
<div id="b" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(d,a){</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">fk</span>(index,d,a<span class="sc">&gt;</span><span class="fl">1e-16</span>)) {</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> index <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>index) {</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>    sum <span class="ot">&lt;-</span> sum <span class="sc">+</span> <span class="fu">fk</span>(i,d,a)</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="c" class="section level4">
<h4>(c)</h4>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(<span class="at">d=</span><span class="dv">2</span>,<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] -0.4313314</code></pre>
</div>
</div>
<div id="question-11.5" class="section level2">
<h2>Question 11.5</h2>
<p>Write a function to solve the equation for a. Compare the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="answer-11.5" class="section level2">
<h2>Answer 11.5</h2>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(u,a){</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(u,a){</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>))<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">integrate</span>(f1,<span class="at">lower =</span> <span class="dv">0</span>,<span class="at">upper =</span> (a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),<span class="at">a=</span>a)<span class="sc">$</span>value  <span class="sc">-</span>  <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>( <span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(pi<span class="sc">*</span>k)<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">integrate</span>(f2,<span class="at">lower =</span> <span class="dv">0</span>,<span class="at">upper =</span> (a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),<span class="at">a=</span>a)<span class="sc">$</span>value  )</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>k_value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k_value)) {</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k_value[i]</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  A[i] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(res)[<span class="dv">1</span>]</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">k=</span>k_value,<span class="at">A_k=</span>A)</span></code></pre></div>
<pre><code>##       k      A_k
## 1     4 1.269415
## 2     5 1.264324
## 3     6 1.262542
## 4     7 1.262440
## 5     8 1.262965
## 6     9 1.263725
## 7    10 1.264515
## 8    11 1.265270
## 9    12 1.265953
## 10   13 1.266592
## 11   14 1.267128
## 12   15 1.267625
## 13   16 1.268050
## 14   17 1.268477
## 15   18 1.268842
## 16   19 1.269173
## 17   20 1.269474
## 18   21 1.269749
## 19   22 1.270002
## 20   23 1.270234
## 21   24 1.270448
## 22   25 1.270646
## 23  100 1.274294
## 24  500 1.275272
## 25 1000 1.275405</code></pre>
<p>As to 11.4,</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 11.4</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt</span>((a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),<span class="at">df=</span>k<span class="dv">-1</span>) <span class="sc">-</span> <span class="fu">pt</span>((a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),<span class="at">df=</span>k)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#k_value &lt;- c(4:25,100,500,1000)</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co">#A &lt;- c()</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:length(k_value)) {</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  k &lt;- k_value[i]</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  res &lt;- uniroot(f,c(0,k^(1/2)))</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  A[i] &lt;- unlist(res)[1]</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="co">#data.frame(k=k_value,A_k=A)</span></span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="dv">0</span>,k<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(res)</span></code></pre></div>
<pre><code>##       root     f.root       iter    init.it estim.prec 
##          0          0          0         NA          0</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question *</h2>
<p>Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer *</h2>
<p>EM algorithm:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">0.91</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(x,y))</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>lambda_new <span class="ot">&lt;-</span> lambda<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(lambda<span class="sc">-</span>lambda_new)<span class="sc">&gt;</span><span class="fl">1e-16</span>) {</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  lambda_new <span class="ot">&lt;-</span> lambda</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># E step</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">+</span>lambda_new,<span class="dv">3</span>)</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M step</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(x,y))</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
<p>MLE:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.5357143</code></pre>
<p>The MLE estimate is much smaller than EM’s result.</p>
</div>
<div id="section-11" class="section level2">
<h2>11-25</h2>
</div>
<div id="question-page-204.1" class="section level2">
<h2>Question page-204.1</h2>
<p>Why are the following two invocations of lapply() equivalent?</p>
<p>trims &lt;- c(0, 0.1, 0.2, 0.5); x &lt;- rcauchy(100)</p>
<p>lapply(trims, function(trim) mean(x, trim = trim)); lapply(trims, mean, x = x)</p>
</div>
<div id="answer-page-204.1" class="section level2">
<h2>Answer page-204.1</h2>
<p>The ‘mean’ function has 2 input parameters, ‘x’ and ‘trim’.</p>
<p>Recall that ’lapply’s inputs: X, FUN, …</p>
<p>X will be used as the first paramater of FUN.</p>
<p>In the question, the second sentence added an ‘x’ after ‘mean’, leading to the first parameter of mean is input by ‘x’. As a result, ‘trims’ will be input to ‘mean’ as the second parameter. So the final result is the same as the first one in the question.</p>
</div>
<div id="question-page-204.5" class="section level2">
<h2>Question page-204.5</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-page-204.5" class="section level2">
<h2>Answer page-204.5</h2>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(formula){</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula,mtcars)</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rsq</span>(mod))</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(formulas, f)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data=</span>data)</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared)</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(bootstraps, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6774122
## 
## [[2]]
## [1] 0.8061072
## 
## [[3]]
## [1] 0.7997079
## 
## [[4]]
## [1] 0.7067493
## 
## [[5]]
## [1] 0.7078747
## 
## [[6]]
## [1] 0.7774177
## 
## [[7]]
## [1] 0.7200399
## 
## [[8]]
## [1] 0.7406424
## 
## [[9]]
## [1] 0.7799331
## 
## [[10]]
## [1] 0.6794392</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(bootstraps[i])</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">rsq</span>(data))</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.6774122
## [1] 0.8061072
## [1] 0.7997079
## [1] 0.7067493
## [1] 0.7078747
## [1] 0.7774177
## [1] 0.7200399
## [1] 0.7406424
## [1] 0.7799331
## [1] 0.6794392</code></pre>
</div>
<div id="question-page-214.1" class="section level2">
<h2>Question page-214.1</h2>
<div id="a-1" class="section level4">
<h4>(a)</h4>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1=</span><span class="fu">rnorm</span>(<span class="dv">10</span>),<span class="at">x2=</span><span class="fu">rchisq</span>(<span class="dv">10</span>,<span class="dv">2</span>),<span class="at">x3=</span><span class="fu">runif</span>(<span class="dv">10</span>))</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>x <span class="co"># dataframe</span></span></code></pre></div>
<pre><code>##              x1        x2         x3
## 1   1.463768513 0.6019313 0.21232575
## 2   0.081306274 3.6924660 0.05007734
## 3   0.504534470 0.8750699 0.88091761
## 4  -0.596404637 2.5920147 0.70236820
## 5  -0.291344310 0.2238821 0.64448458
## 6   0.761717367 0.9633371 0.41528600
## 7  -0.004973426 0.9139509 0.29830427
## 8   0.749788634 2.2505951 0.18822052
## 9   0.136399851 5.3174652 0.57226929
## 10 -1.803829470 2.3865225 0.77191764</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(x,sd,<span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">sd=</span> <span class="dv">1</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    x1    x2    x3 
## 0.892 1.601 0.281</code></pre>
</div>
<div id="b-1" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1=</span>letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],<span class="at">x2=</span><span class="fu">rnorm</span>(<span class="dv">10</span>),<span class="at">x3=</span><span class="fu">runif</span>(<span class="dv">10</span>),<span class="at">x4=</span>letters[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>x <span class="co"># dataframe</span></span></code></pre></div>
<pre><code>##    x1         x2        x3 x4
## 1   a -0.2653786 0.8999494  k
## 2   b -2.1517036 0.9377632  l
## 3   c  0.6403688 0.4760684  m
## 4   d -1.3978768 0.2025054  n
## 5   e -0.4066723 0.3035708  o
## 6   f  0.5712266 0.7295225  p
## 7   g -1.1425464 0.6966989  q
## 8   h  0.8477663 0.5029945  r
## 9   i -0.3937813 0.9265270  s
## 10  j  0.1627073 0.5308530  t</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(x[<span class="fu">which</span>(<span class="fu">vapply</span>(x, is.numeric, <span class="at">FUN.VALUE =</span> <span class="dv">1</span>)<span class="sc">==</span><span class="dv">1</span>)], sd, <span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="at">sd=</span><span class="dv">1</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    x2    x3 
## 0.972 0.260</code></pre>
</div>
</div>
<div id="question-page-214.7" class="section level2">
<h2>Question page-214.7</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</div>
<div id="answer-page-214.7" class="section level2">
<h2>Answer page-214.7</h2>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mcsapply</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>mcsapply <span class="ot">&lt;-</span> <span class="cf">function</span>(X, FUN, ..., <span class="at">simplify =</span> <span class="cn">TRUE</span>,<span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>, <span class="at">mc.cores=</span><span class="dv">2</span>){</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(cores)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">parSapply</span>(cl,X,FUN,...,<span class="at">simplify =</span> simplify, <span class="at">USE.NAMES =</span> USE.NAMES)</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopCluster</span>(cl)</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section-12" class="section level2">
<h2>12-02</h2>
</div>
<div id="question-1." class="section level2">
<h2>Question 1.</h2>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R)</p>
</div>
<div id="answer-1." class="section level2">
<h2>Answer 1.</h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gibbs in rcpp</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="st">NumericMatrix gibbs_cpp(int n, int a, int b){</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix df(10000,2);</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericVector X(10000);</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericVector Y(10000);</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericVector temp(1);</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="st">  X[0]=1;</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="st">  Y[0]=1;</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="st">  for (int i=1;i&lt;10000;i++){</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="st">    temp=rbeta(1,X[i-1]+a,n-X[i-1]+b);</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="st">    Y[i]=temp[0];</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a><span class="st">    temp=rbinom(1,n,Y[i]);</span></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a><span class="st">    X[i]=temp[0];</span></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a><span class="st">  df(_,0)=X;</span></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a><span class="st">  df(_,1)=Y;</span></span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a><span class="st">  return df;</span></span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>data_cpp <span class="ot">&lt;-</span> <span class="fu">gibbs_cpp</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st column is X, 2nd column is Y</span></span></code></pre></div>
</div>
<div id="question-2." class="section level2">
<h2>Question 2.</h2>
<p>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
</div>
<div id="answer-2." class="section level2">
<h2>Answer 2.</h2>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gibbs in r</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>gibbs_r <span class="ot">&lt;-</span> <span class="cf">function</span>(n,a,b){</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">10000</span>)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">10000</span>)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    Y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X[i<span class="dv">-1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>X[i<span class="dv">-1</span>]<span class="sc">+</span>b)</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,Y[i])</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">X=</span>X,<span class="at">Y=</span>Y))</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>data_r <span class="ot">&lt;-</span> <span class="fu">gibbs_r</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="at">x=</span>data_cpp[,<span class="dv">1</span>],<span class="at">y=</span>data_r<span class="sc">$</span>X,<span class="at">xlab =</span> <span class="st">&#39;X from cpp&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;X from R&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="at">x=</span>data_cpp[,<span class="dv">2</span>],<span class="at">y=</span>data_r<span class="sc">$</span>Y,<span class="at">xlab =</span> <span class="st">&#39;Y from cpp&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;Y from R&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3." class="section level2">
<h2>Question 3.</h2>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
</div>
<div id="answer-3." class="section level2">
<h2>Answer 3.</h2>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibbs_r</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">gibbsC=</span><span class="fu">gibbs_cpp</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr        lq    median       uq
## 1 gibbsR 43.139551 45.339301 49.45120
## 2 gibbsC  4.247001  4.496051  4.77775</code></pre>
<p>The computation time Cpp spent is significantly less than R.</p>
</div>
<div id="question-4." class="section level2">
<h2>Question 4.</h2>
<p>Comments your results.</p>
</div>
<div id="answer-4." class="section level2">
<h2>Answer 4.</h2>
<p>From qqplot we found that the data generated from Cpp and R were from the similar or same distribution. In other words, Cpp performs as well as R in terms of data quality.</p>
<p>However, from the results of function ‘microbenchmark’ we can come to the conclusion that Cpp saves much more time for computing. In our daily scientific research, we can make full use of this advantage of Cpp to improve our efficiency.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
